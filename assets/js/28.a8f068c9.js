(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{432:function(s,t,a){"use strict";a.r(t);var e=a(23),l=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"rails-ubuntu-deploy-script"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rails-ubuntu-deploy-script"}},[s._v("#")]),s._v(" Rails Ubuntu Deploy Script")]),s._v(" "),a("blockquote",[a("p",[s._v("Ubuntu18.04 Script 快速建立 Rails 環境")])]),s._v(" "),a("h2",{attrs:{id:"零、版本號"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#零、版本號"}},[s._v("#")]),s._v(" 零、版本號")]),s._v(" "),a("ol",[a("li",[s._v("IP = 111.111.111.111")]),s._v(" "),a("li",[s._v("Ruby = 2.5.1")]),s._v(" "),a("li",[s._v("Bundler = 1.17.3")]),s._v(" "),a("li",[s._v("Project_name = myapp")])]),s._v(" "),a("h2",{attrs:{id:"一、設定"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、設定"}},[s._v("#")]),s._v(" 一、設定")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("需要替換 IP『111.111.111.111』")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("ssh root@111.111.111.111\nadduser deploy\nadduser deploy sudo\nexit\nssh-copy-id deploy@111.111.111.111\nssh deploy@111.111.111.111\n")])])]),a("h2",{attrs:{id:"二、安裝"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、安裝"}},[s._v("#")]),s._v(" 二、安裝")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("需要替換 Ruby版本『2.5.1』 bundler版本『1.17.3』")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('sudo timedatectl set-timezone Asia/Taipei && \\\nsudo locale-gen zh_TW zh_TW.UTF-8 && \\\ncurl -sL https://deb.nodesource.com/setup_10.x | sudo -E bash - && \\\ncurl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add - && \\\necho "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list && \\\nsudo add-apt-repository -y ppa:chris-lea/redis-server && \\\nsudo apt-get update -y && \\\nsudo apt-get install -y git-core curl zlib1g-dev build-essential libssl-dev libreadline-dev libyaml-dev libsqlite3-dev sqlite3 libxml2-dev libxslt1-dev libcurl4-openssl-dev software-properties-common libffi-dev dirmngr gnupg imagemagick apt-transport-https ca-certificates redis-server redis-tools nodejs yarn && \\\nsudo \\curl -sSL https://get.rvm.io | bash && \\\nsource /home/deploy/.rvm/scripts/rvm  && \\\nrvm install 2.5.1  && \\\nrvm list  && \\\ngem install bundler -v 1.17.3 \n')])])]),a("h2",{attrs:{id:"三、檢查"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、檢查"}},[s._v("#")]),s._v(" 三、檢查")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("date  && \\\nruby -v  && \\\nbundle -v  \n")])])]),a("h2",{attrs:{id:"四、可選項目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、可選項目"}},[s._v("#")]),s._v(" 四、可選項目")]),s._v(" "),a("h3",{attrs:{id:"_1-nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-nginx"}},[s._v("#")]),s._v(" 1. nginx")]),s._v(" "),a("ol",[a("li",[s._v("安裝 nginx")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo apt-get -y install nginx && \\\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("為專案建立 symlink")])]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("需要替換『myapp』")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('sudo rm /etc/nginx/sites-enabled/default && \\\nsudo ln -nfs "/home/deploy/myapp/current/config/nginx.conf" "/etc/nginxsites-enabled/myapp"  && \\\nls -lah /etc/nginx/sites-enabled/myapp\n')])])]),a("h3",{attrs:{id:"_2-redis-server"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-redis-server"}},[s._v("#")]),s._v(" 2. redis server")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo add-apt-repository -y ppa:chris-lea/redis-server && \\\nredis-server --daemonize yes\n")])])]),a("h3",{attrs:{id:"_3-postgresql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-postgresql"}},[s._v("#")]),s._v(" 3. postgresql")]),s._v(" "),a("ol",[a("li",[s._v("安裝 postgresql")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo apt-get -y install postgresql postgresql-contrib libpq-dev && \\\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("postgresql 建立專案 db")])]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("需要替換『myapp』")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo su - postgres && \\\ncreateuser --pwprompt deploy && \\\ncreatedb -O deploy myapp\n")])])]),a("h2",{attrs:{id:"五、防火牆"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、防火牆"}},[s._v("#")]),s._v(" 五、防火牆")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo ufw default deny incoming && \\\nsudo ufw default allow outgoing && \\\nsudo ufw allow ssh && \\\nsudo ufw allow http && \\\nsudo ufw allow https && \\\necho y | sudo ufw enable\n")])])])])}),[],!1,null,null,null);t.default=l.exports}}]);