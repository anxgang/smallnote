(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{421:function(e,t,s){"use strict";s.r(t);var r=s(23),a=Object(r.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"關於activerecord-的-inverse-of"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#關於activerecord-的-inverse-of"}},[e._v("#")]),e._v(" 關於ActiveRecord 的 inverse_of")]),e._v(" "),s("p",[e._v("在看spree的source code 的時候發現他在很多model的關聯裡都會加上"),s("code",[e._v("inverse_of")]),e._v("的屬性，好奇地找了一下資料才發現原來是個好物啊！接下來就來說一下inverse_of這個東西。")]),e._v(" "),s("h2",{attrs:{id:"inverse-of-是什麼？"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#inverse-of-是什麼？"}},[e._v("#")]),e._v(" inverse_of 是什麼？")]),e._v(" "),s("p",[e._v("簡單的來說就是兩點"),s("br"),e._v("\n1.讓兩個互相關聯的model可以指到同一個instance物件，在model的資料有更新時讓其他有關聯的model可以即時更新對方的資料。"),s("br"),e._v("\n2.減少資料重複查詢。"),s("br"),e._v("\n這樣講應該很難了解實際上到底是幹麼用的，下面來舉個例子說明一下。")]),e._v(" "),s("h2",{attrs:{id:"accepts-nested-attributes-for-情況下"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#accepts-nested-attributes-for-情況下"}},[e._v("#")]),e._v(" accepts_nested_attributes_for 情況下")]),e._v(" "),s("p",[e._v("在有加入 accepts_nested_attributes_for 的情況下的話就會發生像上面提到的一樣，更新 parent.name 後 son.parent.name 不會跟著一起更新。所以就要為 model 加上 inverse_of 的屬性，這樣在更新 parent 資料後 son.parent 也會指向更新完資料。")]),e._v(" "),s("h2",{attrs:{id:"inverse-of的另一個好處"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#inverse-of的另一個好處"}},[e._v("#")]),e._v(" inverse_of的另一個好處")]),e._v(" "),s("p",[e._v("inverse_of的另一個好處就是減少重複的資料查詢")]),e._v(" "),s("h2",{attrs:{id:"在accepts-nested-attributes-for及validates存在的情況下"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在accepts-nested-attributes-for及validates存在的情況下"}},[e._v("#")]),e._v(" 在accepts_nested_attributes_for及validates存在的情況下")]),e._v(" "),s("p",[e._v("inverse_of 有幾點限制：")]),e._v(" "),s("ul",[s("li",[e._v("不能與 :through 關聯同時使用。")]),e._v(" "),s("li",[e._v("不能與 :polymorphic 關聯同時使用。")]),e._v(" "),s("li",[e._v("不能與 :as 選項同時使用。")])]),e._v(" "),s("p",[e._v("對 belongs_to 關聯，會忽略 has_many 所設定的 inverse_of。")]),e._v(" "),s("blockquote",[s("p",[e._v("參考\nhttp://kuro-sean-blog.logdown.com/posts/729976-about-activerecord-inverse-of")])])])}),[],!1,null,null,null);t.default=a.exports}}]);